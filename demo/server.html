<!DOCTYPE html>

<html><head>
<title>iSignature HTML5签章示例DEMO(端-Windows)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<script type="text/javascript" src="jquery-1.8.3.min.js"></script>


<link rel="stylesheet" href="../kinggrid/dialog/artDialog/ui-dialog.css">
<link rel="stylesheet" href="../kinggrid/core/kinggrid.plus.css">
<link rel="stylesheet" href="../kinggrid/css/search.css">

<script type="text/javascript" src="../kinggrid/core/kinggrid.min.js"></script>
<script type="text/javascript" src="../kinggrid/core/kinggrid.plus.min.js"></script>
<script type="text/javascript" src="../kinggrid/dialog/artDialog/dialog-min.js"></script>
<script type="text/javascript" src="../kinggrid/signature.min.js"></script>
<script type="text/javascript" src="../kinggrid/signature.pc.min.js"></script>
<script type="text/javascript" src="../kinggrid/password.min.js"></script>
<script type="text/javascript" src="../kinggrid/signature_pad.min.js"></script>
<script type="text/javascript" src="../kinggrid/jquery.timer.dev.js"></script>
<script type="text/javascript" src="../kinggrid/jquery.qrcode.min.js"></script>
<script type="text/javascript" src="../kinggrid/qrcode.min.js"></script>
<script type="text/javascript" src="../kinggrid/jsQR.js"></script>
<script type="text/javascript" src="../kinggrid/search.js" charset="utf-8"></script>
<style type="text/css">
@media print{
#in{ display:none}
}

table{margin: 0 auto;}
</style>



<script type="text/javascript">
if(!window['console']){//IE8，没有改对象，创建一个对象
	window['console'] = {log: function(){}}
}
var iframeDialog = true;

function delCB(signatureid, signData){
	   if(Signature.list != null && Signature.list[signatureid] != null){
		   var signatureCreator = Signature.create();
		   signatureCreator.removeSignature(signData.documentid, signatureid);
	   }
	   return true;
}

	Signature.init({//初始化属性
	  keysn:'0E4E451202271214',
	  delCallBack: delCB,
	  imgtag: 0, //签章类型：0：无; 1:公章; 2:私章; 3:法人章; 4:法人签名; 5:手写签名
	 // showSealsDlg: false,
	//  password:'123456',
	  moveable: true,
	  timestamp: true,  //获取签章服务器时间
	//signdate : {ischeck: true, fontFormat:'yyyy/MM/dd',fontFamily:'楷体',fontSize:12,fontColor:'#00CC00',position:'居右下(章内)'},
		valid : false,    //签章和证书有效期判断， 缺省不做判断
       icon_move : true, //移动签章按钮隐藏显示，缺省显示
       icon_remove : true, //撤销签章按钮隐藏显示，缺省显示
       icon_sign : true, //数字签名按钮隐藏显示，缺省显示
       icon_signverify : true, //签名验证按钮隐藏显示，缺省显示
       icon_sealinfo : true, //签章验证按钮隐藏显示，缺省显示
		certType : 'server',//设置证书在签章服务器
		sealType : 'server',//设置印章从签章服务器取
		serverUrl : 'http://192.168.0.130:8080/iSignatureHTML5',//
		documentid:'KG2016093001',//设置文档ID
		documentname:'测试文档KG2016093001',//设置文档名称
		//pw_enc_save : true,//密码是否加密保存
		//pw_server_timeout:true,
		pw_timeout:'s1800', //s：秒；h:小时；d:天
		//cache_path:'/app/netarb/cietacweb_war.ear/cietacweb.war',
	    scaleImage: 0.5 //签章图片的缩放比例
	})

	//kinggrid.options.timeout=40000;
	
		window.onload = function(){
			var signs =[
			            {
			            	 extra:{
			            		    icon_move: function(){
			            		    	alert('禁止移动');
			            		    	return false;
			            		    },
			                        scaleImage:1
				            }, 
			            	signatureid:'147683973060447728',
			            	signatureData:'eyJ0aW1lc3RhbXAiOnsidGltZSI6MTQ3NjgzOTczMDM1Mn0sImFwcG5hbWUiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNTMuMC4yNzg1LjE0MyBTYWZhcmkvNTM3LjM2IiwiZG9jdW1lbnRpZCI6IktHMjAxNjA5MzAwMSIsImRvY3VtZW50bmFtZSI6Iua1i+ivleaWh+aho0tHMjAxNjA5MzAwMSIsIm1vdmVhYmxlIjp0cnVlLCJrZXlzbiI6IjNEMkI1NTMwMDMyMjA1MTQiLCJvcmduYW1lIjoi6YeR5qC856eR5oqA5b6Q5qC56Iux5rWL6K+VMDEiLCJ1c2VybmFtZSI6InhiIiwic2VhbCI6eyJoZWlnaHQiOiIyLjk5IiwiaW1nZGF0YSI6ImdUbnhvYStDSlozRU41ZC84ZTBzUTlIV1Z5cVBiQkxraEFJdTE9ZndPdFNSTVlHNm1wREtjelVsRlh2ajI0cmk3ZWM9K2R4PUE2Z1RwZ2ROZ2dnZ2dnL2lpaW1nZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnbkNYVGdvZ2dnb2dFZ2dnZ2duMmdDb2dnZ3NyTk5BWlNqY0Z2MmM9cmFjT3VmZXR3Zkkza3FLUzZ3Z01LbUNQY3dJR2p2aDUyTW5oYmRieHhKaUp0Mz1POXhTa2NUT0swU2xEZnhyUkJHNm5iUjRob1JWeUV0TVlFQjRYa1FqUFUveG1qZVU2SHJibEdwanZRcmlpMFdBWGhKZVdIV3ZhSWVZeUp3ZTBoRlNlb2NINUxWSUUxWlo9UXBVOHV0SU5mdEdiTyswVzN2TElPdjE5d3Q9Tz0zdFJ0VExHUlhkcEJQTHZSVDBBdWpyckdXK2tCPUZ5UjJXbjZIUE5NMmRteU42VHB6U2ptNUxSRFNsMGM0enVsOUNOWUN4MVlMb0x1R3hPa0VsZlBidkZEK2lSYllZR21CUlhsZEtWdmlsSWp1V3l0SWlvNndzaWdnVjJUcTNMNkhLbmRuMG89anhJPXdoZWRpMUFxM1VJcERScmN4ZWdlQ1dtRnVRekZUeURBNTl1Wm9JZENBUXFWTUl0WEVEOVpmNHk5K2Z0dzFVME53TmRVMT09VU5iPWRFaThycWJRUVBIOCt3MlVaME9RV0srT1FiZFhCVFpLUzE1ckh2TFR4cVNvM3NnR1cyMj05cVl6RXkzUVYzNitMekIzK1ljd3FlKzBUODNsaj1YYk9MdkhsV3U5RUIycG91YStuem01UjQrQUYySklQV3BzTnV5NmhmYlNyWDBTam1LM0pBUTZDdUFhNCtMTXdaQjBBOCt2TVlzYUw9b3F5d2xXcVFLcz1RcHdCT2xGMkErTWhnMmV3eWxqUnJySHh3K3dVZHpqT1lJZHBvYml1PUZucitBaXdxd1JRZ3ZjSkhzR0p2cEVhbXByR2lxdmZhckVJSHZVYj1RYjVaZkNUNHJMUldvSVg0K0VLV3I0THdVVWNhd3J5PWdmNlBsZ2w5YWdUV3VraE5mYzV0PUZ2OFdXeGwyRDgvaGhkaUo9PXRCNEJSMXVWZ2o9eVZIQUFxQ0JlR1RmZ3d6SjhGaHFqdC9BTEVCYW1VYWllOWFWSjFnMXVBSDBQK016eWZOTkVFUEpVbFNMcEg5QTlEaTRVNVU4eFR5T1dVbURKOUl1STFsRGF0MHhOY0V0PWxkeFQwMTFBeitydkoybEhpamwrY2FRMFl1Qjh5c3lBKzMvUXR2WnR3U0doczFBM0RrQUllKzBQbGZGVkpFdDU4aHNmbE5mWUgra1hTc1h3SmV2alJFME9seGZxWnZzdW1UWnhEOXZrMT11d3NiU1VNOWl3MVp5K3RIZHVHME5mbm5kRDFJT09TdHgzdTlBYUxTPWhQMVFZSUpZcmJhM3l2ZEtTT25SUzJZcFNJeUQ9ZFZIU29ZYzVmZkViVGtyK01rSU8wTFZHTHFrVm1hcVNXaW9LQk9ST2N5b3BHSGF6aFJGRlJQbVUweU93TlJMVVZMRnZyWGFQT1c4dEpBR0lEdlNZR1lsRHVYY09TaktCPVM2SjVBcjI0ZGoySmpKakRIRjFCa3NrVjlCUzAwSXZ1UDI9bElHZFJZNjlPeGhCQ252K2E0UENuT0JiMjlHMGVHRXZFZ3Q0clZ4Y2JOVFBsUVM2cHBSM1lmaGYxWk5GTUdSM3dxS0pUL3NXSlJKUz05eXRTb2pGcENtdVFBbEdXeDVjRDNSVXZRNHlLTk9TaWRCREUwaU5MYlAzNG9lM1V6bWNTPWZxbHM5WmpNVzAzYWhsRE9VL2ZlV1ZSUDU1anpCTkNZdVgyR2hZV0VJcm5yenNURXRXQjBnUEtPb3Qrd3MwQWlRcDg5TEVCcEhwdTlsTXdTPWNqeWloQXJVTklmWnhjWTN0QTBaSnpIWHlJYnNUdWZWcENWUjlXZk5Ra1VwRHFJR0dlREh1d01McnJUL2FwWVlmMVdJa1dlTXl2cllMVmZraUlsSXYyM3RFUnNrRWdiNjZDam8yaHZjUjJ5eDY0Ry8vTkcwWGFENG1mRjRqZWVzUmtsVThIdS9iRzZoL2NYRDJoMFd1anBudlFHR2t1RzhZNmlyPStDMy9LMlA2NDI2MDZqdjBVWmlpaWhQQzhUS29nb2dkbTc3IiwiaW1nZXh0IjoiLmdpZiIsInNpZ25uYW1lIjoi5b6Q6I2j57uP55CG562+5ZCNIiwic2lnbnNuIjoiZ1RueG9hK0NKWjNFTjVkLzhlMHNROUhXVnlxUGJCTGtoQUl1MT1md090U1JNWUc2bXBES2N6VWxGWHZqMjRyaTciLCJ1c2VybmFtZSI6InhiIiwid2lkdGgiOiI0Ljk3In0sInByb3RlY3RlZERhdGEiOlt7ImZpZWxkIjoiaXRlbTEiLCJkZXNjIjoi5L+d5oqk6aG5MSIsInZhbHVlIjoi5ZCM5Yib6L2v5Lu25YWs5Y+4In0seyJmaWVsZCI6Iml0ZW0yIiwiZGVzYyI6IuS/neaKpOmhuTIiLCJ2YWx1ZSI6IumHkeagvOenkeaKgOaciemZkOWFrOWPuCJ9LHsiZmllbGQiOiJpdGVtMyIsImRlc2MiOiLkv53miqTpobkzIiwidmFsdWUiOiLmoLnmja7jgIrlkIjlkIzms5XjgIvlj4rmnInlhbPop4TlrprvvIznu4/lj4zmlrnljY/llYbvvIzovr7miJDkuIDoh7TvvIznrb7orqLmnKzlkIjlkIzjgIJcclxu5LiA44CB55Sy5pa55aeU5omY5LmZ5pa55Yi25L2c5peg57q45YyW5Yqe5YWs57O75YiX5Lqn5ZOB44CCXHJcbuS6jOOAgeWFt+S9k+inhOagvOWei+WPt+OAgeaVsOmHj+OAgeWNleS7t+WPiuS7t+agvOivpuingemZhOWQjua4heWNleOAglxyXG7kuInjgIHkuqTotKfml7bpl7TvvJo2MOW3peS9nOaXpVxyXG7lm5vjgIHpqozmlLbmnJ/pmZDvvJoyMOW3peS9nOaXpeOAglxyXG7kupTjgIHlj4zmlrnlnKjlkIjlkIzkuIrnlLXlrZDnrb7lrZfnm5bnq6DlkI7nq4vljbPnlJ/mlYjjgIIifV0sInNlYWxUeXBlIjoiY2xpZW50IiwicG9zaXRpb24iOnsicG9zMCI6eyJtYXJnaW5MZWZ0IjoiMzEycHgiLCJtYXJnaW5Ub3AiOiIwLjgxMjVweCJ9fSwidGltZWlkIjoxNDc2ODM5NzMwNjA0LCJ2ZXIiOnsibmFtZSI6IjEuMC4yMCIsImNvZGUiOjEwMH19'
			            }
			            ];
			/* Signature.loadSignatures(signs);
			Signature.bind({
				remove:function(fn){//签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,
					console.log('获取删除的签章ID：'+this.getSignatureid());
					fn(true);//保存成功后必须回调fn(true/false)传入true/false分别表示保存成功和失败
				
				},
				update:function(fn){//签章数据有变动时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,执行后必须回调fn(true/false)，传入true/false分别表示保存成功和失败
					console.log('获取更新的签章ID：'+this.getSignatureid());
					//console.log('获取更新的签章数据：'+this.getSignatureData());
					fn(true);
				}
			}); */

		
            ////////////////////////////////////
		 	var signatureCreator = Signature.create();
			signatureCreator.getSaveSignatures("KG2016093001", function(signs){
				var signdata = new Array();
				var jsonList = eval("("+signs+")");
				for(var i=0;i<jsonList.length;i++){
					      var map = {};
					      map.signatureid = jsonList[i]["signatureId"];
					      map.signatureData = jsonList[i]["signature"];
					      signdata.push(map);
				 }
				Signature.loadSignatures(signdata); 
			});
			////////////////////////////////////
			
		 window.onbeforeunload = onbeforeunload_handler;
	     window.onunload = onunload_handler;
	     function onbeforeunload_handler() {
	       
	     }
	     function onunload_handler() {
	    	 Signature.clearRPW();
	     }  	

         ///////////绑定搜索/////////////
	     bindDOM("ipt", "ser_box", "bot_box", "oul", function(){
	    	 var signatureCreator = Signature.create();
	    	 signatureCreator.loadSeals(function(data){
	    	     setSeals(data);
	    	 });
	     });
		
		/////////////////////////////////
	}
</script>
</head>

<body>

<table width=100% height=100% border="0" cellspacing="0" cellpadding="0" bgcolor="ffffff">
<tr>
  <td align="center" id="in">
    <!-- <input type="button" onclick="modifyPwd()" value="密码修改"> -->
	<input type="button" pos="pos0" class="test" value="甲方签章">
	<!-- <input type="button" pos="pos0" class="testPwd" value="电子签章先密码"> -->
	<!-- <input type="button" pos="pos0" class="testV" value="测试签章"> -->
	<!-- <input type="button" pos="pos0" class="testHWD" value="手写签名(设备)"> -->
	<!-- <input type="button" pos="pos0" class="testFP" value="指纹签名(设备)"> -->
	<input type="button" pos="pos3" class="test" value="乙方签章">
	<input type="button" pos="pos0" class="testSign" value="签章(数字签名)">
    <input type="button" pos="pos0" class="testHW" value="手写签名">
    <input type="button" pos="pos0" class="testBC" value="二维码">
     <input type="button" pos="pos1" class="testSave" value="保存签章"> 
   <!-- <input type="button" pos="pos0" class="testScanBC" value="扫码签章">
<!-- 	<input type="button" pos="pos1" class="test" value="盖章位置B"> -->
	<input type="button" onclick="verifySignature()" value="验证签章">
	<input type="button" onclick="showSignature()" value="显示签章">
	<input type="button" onclick="hideSignature()" value="隐藏签章">
	<input type="button" onclick="takeCare();" id="yfdiv" value="注意事项">
    <!-- <br>本页为普通页面，用户可根据自己的需求更改。注意：签章密码为<font color="red">000000</font>。正式版iSignature电子签章HTML版的签章保存在用户智能印章钥匙盘上，支持身份认证和数字证书，符合《电子签名法》。 -->
  </td>
</tr>
	<tr>
  <td id=Page>
    <table width="758" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="ffffff" style="align:center">
<tr><td height="50" align="center" valign="bottom"><font color="red" size="6"><b>订购合同<b></font></td></tr>
<tr><td height="50" align="center"><div>合同编号:KG2016093001</div>
   	<div id="ser_box">
				<input type="search" id="ipt" />
				   <span><input id="sousuo" pos="pos0" value="搜索签章" class="s_btn" type="submit"></span>
			</div>

			<div id="bot_box">
				<ul id="oul"></ul>
			</div>
</td></tr>
<tr>
<td>
<table width="600" border="0" cellspacing="0" cellpadding="0" align="center" >
<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" nowrap>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
  <tr height="30">
      <td width=96 align=left><font color="red">甲方：</font></td>
      <td ><input type="text" id="item1" kg-desc="保护项1" value="同创软件公司">  </td>

      <td width=96  align=right><font color="red">乙方：</font></td>

      <td ><input type="text" id="item2" kg-desc="保护项2" value="金格科技有限公司"></td>
   </tr>
   <tr height="30">
      <td width=96 align=left><font color="red">协议编号：</font></td>
      <td ><input type="text" id="XYBH" value="KG0014"> </td>

      <td width=96  align=right><font color="red">保密级别：</font></td>

      <td ><input type="text" id="BMJH" kg-desc="保护项1" value="中级0"> </td>
   </tr>
</table>
</td>
</tr>



<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="300" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
              <td valign="top"><font color="red" >合作内容：</font>&nbsp;
            </tr>
           <tr>
              <td height="100%">
		<textarea rows="" cols="" id="item3" kg-desc="保护项3" style="overflow:auto;border:0;width:85%;height:95%;font-size: 14px;line-height: 2.5;padding-left:80px;">根据《合同法》及有关规定，经双方协商，达成一致，签订本合同。
一、甲方委托乙方制作无纸化办公系列产品。
二、具体规格型号、数量、单价及价格详见附后清单。
三、交货时间：60工作日
四、验收期限：20工作日。
五、双方在合同上电子签字盖章后立即生效。</textarea>
       </td>
            </tr>
</table>
</td>
<tr>


<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="100" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
              <td valign="top"><font color="red" >权利责任：</font>&nbsp;
            </tr>
            <tr>
              <td height="100%">
		<Textarea id="QLZR" name=QLZR  class=inputcss style="overflow:auto;border:0;width:85%;height:85%;font-size: 14px;line-height: 2.5;padding-left:80px " >内容完整性鉴别</Textarea>
       </td>
            </tr>
</table>
</td>
</tr>

<tr>
<td  height="250">
 
	 <table width="100%" height="250" border="0" cellspacing="0" cellpadding="0" align="center"style=" border-bottom:1px solid; border-color:#ff0000;position:relative;">
            <tr height="250" style="position:absolute">
              <td width=100 valign="top" ><font color="red" >甲方签章：</font> </td>   
              <td width=200 height="250" style="border-bottom:1px solid; border-color:#ff0000;cursor:hand" valign="top">
			    <div style="position:absolute">
	               <div id="pos0"></div>
	            </div>
			  </td>
              <td width=100 valign="top" ><font color="red" >乙方签章：</font> </td>   
              <td width=200 height="250" style="border-bottom:1px solid; border-color:#ff0000;cursor:hand" valign="top">
			     <div style="position:absolute">
	               <div id="pos3"></div>
	            </div>
			  </td>
            </tr>
	 </table>

</td>
</tr>

<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="40" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
      <td width="100"  ><font color="red">&nbsp;产品名称：</font></td>
      <td><input type="text" id="CPMC" kg-desc="保护项1" value="iSignature电子签章系统"> 
   </tr>
</table>
</td>
</tr>
<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="40" nowrap  >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%" >
   <tr>
      <td width="100" ><font color="red">&nbsp;订购数量：</font></td>
      <td><input type="text" id="DGSL" value="53"> </td>
   </tr>
</table>
</td>
</tr>
<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="40" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
      <td width="100" ><font color="red">&nbsp;订购日期：</font></td>
      <td><input type="text" id="DGRQ" value="2016-10-18"> </td>
   </tr>
</table>
</td>
</tr>


<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="1" nowrap >
</td>
</tr>
</table>
</td>
</tr>
<tr><td height="60">&nbsp;</td></tr>
    </table>

  </td>
  <td width=2></td>
</tr>
<tr>
  <td height=2></td>
  <td></td>
</tr>

</table>


<script type="text/javascript">


function verifySignature() {

	var invalidSignatureArray = Signature.verify();//返回无效签章
	if (invalidSignatureArray.length > 0) {
		for (var i = 0; i < invalidSignatureArray.length; i++) {
			var signature = invalidSignatureArray[i];
			//console.log(signature.modifiedItems);//获取修改的保护项
		}
		
	}else{
		Signature.alert("当前文档所有签章有效");
	}
}
function findUpdateSignature(){
	var updateList = Signature.updateList;
	$('#pos2').html('<div>获取有更新的签章数据:</div>');
	for (var i = 0; i < updateList.length; i++) {
		var signature = updateList[i];
		$('#pos2').append('<div>'+signature.getSignatureid()+":"+signature.getSignatureData()+'</div>');
	}
}

function findRemoveSignature(){
	var removeList = Signature.removeList;
	$('#pos1').html('<div>获取删除的签章ID：</div>');
	for (var i = 0; i < removeList.length; i++) {
		var signatureid = removeList[i];
		$('#pos1').append('<div>'+signatureid+'</div>');
	}
}

function showSignature() {
	Signature.show();
}


function hideSignature() {
	Signature.hide();
}


$('.test').click(function() {
			
	var signatureCreator = Signature.create(/* {
			keysn : '000000999516', //可以通过密钥盘序号或者用户编码获取签章。
			authcode:'F08902A0DBE849BEB0EE076115B6C0FC'
		    //usercode:'4D58323738136645'//获取签章服务器用户编码为“test”的印章	
		} */);
		var that = this;
		var protectedItems = signatureCreator.run({
			protectedItems : [ 'item1', 'item2', 'item3' ],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
			position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
			autoCert : false,
			/*changeOffsetXY:function(img){
				var ret = {offsetX:img.width/2,offsetY:img.height/2};
				return ret;
			},*/
			okCall : function(fn, image) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
				console.log("盖章ID：" + this.getSignatureid());
				console.log("盖章数据：" + this.getSignatureData());
				fn(true);

				var images = signatureCreator.getSealsByKeysn('T001');
				if(images != null){
					for(var i = 0; i < images.length; ++i){
						alert(images[i]);
					}
				}
			},
			cancelCall : function() {//点击取消后的回调方法
				console.log("取消！")
			}
		});
	});
	
	//手写签名设备连接
	$('.testHWD').click(function(){
		var signatureCreator = Signature.create();
		var that = this;
		signatureCreator.handWriteDevice({
			device_type: '0',//设备类型 默认为0（iPadControls组件设备Wacom STU-530/430/500B专用）
			copy_right:"7RkMye7b2srQserXvLy8yvXR0L6/1Lpb16jTw107MjAxNTsxMTsxMjtFWD1ERU1PXzc7VlA9RmFsc2U7VUM9RmFsc2U7VTg9RmFsc2U7Uk09RmFsc2U7TVQ9RmFsc2U7QVM9RmFsc2U7Sk09RmFsc2U7RkM9Nzs=",//设备授权码
			onBegin: function() {
				console.log('onbegin');
			},
			errorCall:function(){
				console.log('errorCall');
			},
			onEnd: function() {
				console.log('onEnd');
			}
		}, function(param){
			//alert(param.imageData);
			signatureCreator.runHW(param, {
				protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
				position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
				okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
					console.log("盖章ID："+this.getSignatureid());
					console.log("盖章数据："+this.getSignatureData());
					fn(true);
				},
				cancelCall : function() {//点击取消后的回调方法
					console.log("取消！")
				}
			});
		});
	}); 
	
	//指纹设备连接
	$('.testFP').click(function(){
		var signatureCreator = Signature.create();
		var that = this;
		signatureCreator.fingerPrintsDevice({
			device_type: '0',//设备类型 默认为0（iWebFingerPrints组件设备(指昂ZWY-060)）
			image_type :'gif',
			onBegin: function() {
				console.log('onbegin');
			},
			errorCall:function(){
				console.log('errorCall');
			},
			onEnd: function() {
				console.log('onEnd');
			}
		}, function(param){
			//alert(param.imageData);
			signatureCreator.runHW(param, {
				protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
				position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
				okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
					console.log("盖章ID："+this.getSignatureid());
					console.log("盖章数据："+this.getSignatureData());
					fn(true);
				},
				cancelCall : function() {//点击取消后的回调方法
					console.log("取消！")
				}
			});
		});
	});
	
	$('.testV').click(function(){
		var signatureCreator = Signature.create();
		var that = this;
		var param = {name:"金格测试",width:"4",height:"4",imageData:"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"};
		signatureCreator.runHW(param, {
			protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
			position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
			okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
				console.log("盖章ID："+this.getSignatureid());
				console.log("盖章数据："+this.getSignatureData());
				fn(true);
			},
			cancelCall : function() {//点击取消后的回调方法
				console.log("取消！")
			}
		});
	});
	$('.testSign').click(function() {
		var signatureCreator = Signature.create({
			keysn : '0741170010110516', //可以通过密钥盘序号或者用户编码获取签章。
		//usercode:'4D58323738136645'//获取签章服务器用户编码为“test”的印章	
		});
		var that = this;
		var protectedItems = signatureCreator.run({
			protectedItems : [ 'item1', 'item2', 'item3' ],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
			position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
			autoCert : true,
			okCall : function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
				console.log("盖章ID：" + this.getSignatureid());
				console.log("盖章数据：" + this.getSignatureData());
				fn(true);

			},
			cancelCall : function() {//点击取消后的回调方法
				console.log("取消！")
			}
		});
	});

	$('.testHW').click(
			function(){
				var signatureCreator = Signature.create();
				var that = this;
				
				signatureCreator.handWriteDlg({
					image_height: "6.7",
					image_width: "5",
					onBegin: function() {
						console.log('onbegin');
					},
					onEnd: function() {
						console.log('onEnd');
					}
				}, function(param){
					//alert(param.imageData);
					signatureCreator.runHW(param, {
						protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
						position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
						okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
							console.log("盖章ID："+this.getSignatureid());
							console.log("盖章数据："+this.getSignatureData());
							fn(true);
						},
						cancelCall : function() {//点击取消后的回调方法
							console.log("取消！")
						}
					});
				});
			}
		);

	$('.testBC').click(function() {
		var signatureCreator = Signature.create();
		var that = this;

		signatureCreator.barCodeDlg({
			image_height : "6.7",
			image_width : "5",
		}, function(param) {
			alert(param.imageData);
			signatureCreator.runHW(param, {
				protectedItems : [ 'item1', 'item2', 'item3' ],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
				position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
				okCall : function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
					console.log("盖章ID：" + this.getSignatureid());
					console.log("盖章数据：" + this.getSignatureData());
					fn(true);
				},
				cancelCall : function() {//点击取消后的回调方法
					console.log("取消！")
				}
			});
		});
	});

	$('.testScanBC').click(function() {
		var signatureCreator = Signature.create();
		var that = this;

		signatureCreator.scanBCDlg({
			image_height : "5",
			image_width : "5",
			content : 123
		}, function(param) {
			//alert(param.imageData);
			signatureCreator.runHW(param, {
				protectedItems : [ 'item1', 'item2', 'item3' ],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
				position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
				okCall : function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
					console.log("盖章ID：" + this.getSignatureid());
					console.log("盖章数据：" + this.getSignatureData());
					fn(true);
				},
				cancelCall : function() {//点击取消后的回调方法
					console.log("取消！")
				}
			});
		});
	});
	
	$('.testSave').click(
			function(){
				var signatureCreator = Signature.create();
				var that = this;
				var list = Signature.list;
				for ( var key in list) {
					var tt = list[key];
					signatureCreator.saveSignature("KG2016093001", key, list[key].getSignatureData());
				}
				alert("签章保存成功！");
			}
	   ); 

	$('.s_btn').click(
			 function(){
				 var signatureCreator = Signature.create();
				 var that = this;
				 signatureCreator.runSS({
						protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
						position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
					    autoCert : false,
						okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
							console.log("盖章ID："+this.getSignatureid());
							console.log("盖章数据："+this.getSignatureData());
							fn(true);
						},
						cancelCall : function() {//点击取消后的回调方法
							console.log("取消！")
						},
						beginCall: function(){
							//alert(123);
						},
						endCall: function(){
							//alert(456);
						}
					}, getSeal());
			 }
	  );
	$('.testPwd').click(function(){
		var signatureCreator = Signature.create();
		var that = this;
		signatureCreator.runPwd({
			protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
			position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
			autoCert:false,
			okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
				console.log("盖章ID："+this.getSignatureid());
				console.log("盖章数据："+this.getSignatureData());
				fn(true);
								
			},
			cancelCall : function() {//点击取消后的回调方法
				console.log("取消！")
			}
		});
	})
	function takeCare() {
		Signature
				.alert('注意：（1）请先在签章服务器发放用户编码为"test"的用户并做印章。<br>（2） 由于IE9及以下浏览器受限，请使用其他浏览器访问本页面，如果需要IE访问，<br>复制本页面目录和kinggrid文件夹至服务器端访问。 ');
	}

	function modifyPwd() {

		var signatureCreator = Signature.create();
		console.log(signatureCreator);
		signatureCreator.modifyPwd({
			successCall : function(response) {

			},
			errorCall : function(code) {

			}
		});

	}
</script>
