<!DOCTYPE html>

<html><head>
<title>iSignature HTML5签章示例DEMO(客户端-Windows)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<script type="text/javascript" src="${contextPath}/demo/jquery-1.8.3.min.js"></script>


<link rel="stylesheet" href="${contextPath}/kinggrid/dialog/artDialog/ui-dialog.css">
<link rel="stylesheet" href="${contextPath}/kinggrid/core/kinggrid.plus.css">

<script type="text/javascript" src="${contextPath}/kinggrid/core/kinggrid.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/core/kinggrid.plus.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/dialog/artDialog/dialog-min.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/signature.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/signature.pc.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/password.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/signature_pad.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/jquery.timer.dev.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/jquery.qrcode.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/qrcode.js"></script>
<script type="text/javascript" src="${contextPath}/kinggrid/jsQR.js"></script>
<style type="text/css">
@media print{
#in{ display:none}
}
#Page input{border:0}
</style>



<script type="text/javascript">
if(!window['console']){//IE8，没有改对象，创建一个对象
	window['console'] = {log: function(){}}
}

function delCB(signatureid, signData){
	   if(Signature.list != null && Signature.list[signatureid] != null){
		   var signatureCreator = Signature.create();
		   signatureCreator.removeSignature(signData.documentid, signatureid);
	   }
	   return true;
}

	Signature.init({//初始化属性
		//     3D2B553003220514     321322198602058813
	  // keysn:'0741170010110516',
	 // keysn:'T001',
	  delCallBack: delCB,
	  imgtag: 1, //签章类型：0：无; 1:公章; 2:私章; 3:法人章; 4:法人签名; 5:手写签名
	  moveable: true,
		valid : false,    //签章和证书有效期判断， 缺省不做判断
       icon_move : true, //移动签章按钮隐藏显示，缺省显示
       icon_remove : true, //撤销签章按钮隐藏显示，缺省显示
       icon_sign : true, //数字签名按钮隐藏显示，缺省显示
       icon_signverify : true, //签名验证按钮隐藏显示，缺省显示
       icon_sealinfo : true, //签章验证按钮隐藏显示，缺省显示
		certType : 'client',//设置证书在签章服务器
		sealType : 'client',//设置印章从签章服务器取
		//serverUrl : 'http://192.168.0.130:8080/iSignatureH5',//
		documentid:'1503455980863',//设置文档ID
		documentname:'测试文档1503455980863',//设置文档名称
		pw_timeout:'s1800', //s：秒；h:小时；d:天
	    //scaleImage: 0.5 //签章图片的缩放比例
	})

	//kinggrid.options.timeout=40000;
	
		window.onload = function(){
			var signs =[
			            {
			            	 extra:{
			            		    icon_move: function(){
			            		    	alert('禁止移动');
			            		    	return false;
			            		    },
			                        //scaleImage:0.5
				            }, 
			            	signatureid:'147683973060447728',
			            	signatureData:'eyJ0aW1lc3RhbXAiOnsidGltZSI6MTQ3NjgzOTczMDM1Mn0sImFwcG5hbWUiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNTMuMC4yNzg1LjE0MyBTYWZhcmkvNTM3LjM2IiwiZG9jdW1lbnRpZCI6IktHMjAxNjA5MzAwMSIsImRvY3VtZW50bmFtZSI6Iua1i+ivleaWh+aho0tHMjAxNjA5MzAwMSIsIm1vdmVhYmxlIjp0cnVlLCJrZXlzbiI6IjNEMkI1NTMwMDMyMjA1MTQiLCJvcmduYW1lIjoi6YeR5qC856eR5oqA5b6Q5qC56Iux5rWL6K+VMDEiLCJ1c2VybmFtZSI6InhiIiwic2VhbCI6eyJoZWlnaHQiOiIyLjk5IiwiaW1nZGF0YSI6ImdUbnhvYStDSlozRU41ZC84ZTBzUTlIV1Z5cVBiQkxraEFJdTE9ZndPdFNSTVlHNm1wREtjelVsRlh2ajI0cmk3ZWM9K2R4PUE2Z1RwZ2ROZ2dnZ2dnL2lpaW1nZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnbkNYVGdvZ2dnb2dFZ2dnZ2duMmdDb2dnZ3NyTk5BWlNqY0Z2MmM9cmFjT3VmZXR3Zkkza3FLUzZ3Z01LbUNQY3dJR2p2aDUyTW5oYmRieHhKaUp0Mz1POXhTa2NUT0swU2xEZnhyUkJHNm5iUjRob1JWeUV0TVlFQjRYa1FqUFUveG1qZVU2SHJibEdwanZRcmlpMFdBWGhKZVdIV3ZhSWVZeUp3ZTBoRlNlb2NINUxWSUUxWlo9UXBVOHV0SU5mdEdiTyswVzN2TElPdjE5d3Q9Tz0zdFJ0VExHUlhkcEJQTHZSVDBBdWpyckdXK2tCPUZ5UjJXbjZIUE5NMmRteU42VHB6U2ptNUxSRFNsMGM0enVsOUNOWUN4MVlMb0x1R3hPa0VsZlBidkZEK2lSYllZR21CUlhsZEtWdmlsSWp1V3l0SWlvNndzaWdnVjJUcTNMNkhLbmRuMG89anhJPXdoZWRpMUFxM1VJcERScmN4ZWdlQ1dtRnVRekZUeURBNTl1Wm9JZENBUXFWTUl0WEVEOVpmNHk5K2Z0dzFVME53TmRVMT09VU5iPWRFaThycWJRUVBIOCt3MlVaME9RV0srT1FiZFhCVFpLUzE1ckh2TFR4cVNvM3NnR1cyMj05cVl6RXkzUVYzNitMekIzK1ljd3FlKzBUODNsaj1YYk9MdkhsV3U5RUIycG91YStuem01UjQrQUYySklQV3BzTnV5NmhmYlNyWDBTam1LM0pBUTZDdUFhNCtMTXdaQjBBOCt2TVlzYUw9b3F5d2xXcVFLcz1RcHdCT2xGMkErTWhnMmV3eWxqUnJySHh3K3dVZHpqT1lJZHBvYml1PUZucitBaXdxd1JRZ3ZjSkhzR0p2cEVhbXByR2lxdmZhckVJSHZVYj1RYjVaZkNUNHJMUldvSVg0K0VLV3I0THdVVWNhd3J5PWdmNlBsZ2w5YWdUV3VraE5mYzV0PUZ2OFdXeGwyRDgvaGhkaUo9PXRCNEJSMXVWZ2o9eVZIQUFxQ0JlR1RmZ3d6SjhGaHFqdC9BTEVCYW1VYWllOWFWSjFnMXVBSDBQK016eWZOTkVFUEpVbFNMcEg5QTlEaTRVNVU4eFR5T1dVbURKOUl1STFsRGF0MHhOY0V0PWxkeFQwMTFBeitydkoybEhpamwrY2FRMFl1Qjh5c3lBKzMvUXR2WnR3U0doczFBM0RrQUllKzBQbGZGVkpFdDU4aHNmbE5mWUgra1hTc1h3SmV2alJFME9seGZxWnZzdW1UWnhEOXZrMT11d3NiU1VNOWl3MVp5K3RIZHVHME5mbm5kRDFJT09TdHgzdTlBYUxTPWhQMVFZSUpZcmJhM3l2ZEtTT25SUzJZcFNJeUQ9ZFZIU29ZYzVmZkViVGtyK01rSU8wTFZHTHFrVm1hcVNXaW9LQk9ST2N5b3BHSGF6aFJGRlJQbVUweU93TlJMVVZMRnZyWGFQT1c4dEpBR0lEdlNZR1lsRHVYY09TaktCPVM2SjVBcjI0ZGoySmpKakRIRjFCa3NrVjlCUzAwSXZ1UDI9bElHZFJZNjlPeGhCQ252K2E0UENuT0JiMjlHMGVHRXZFZ3Q0clZ4Y2JOVFBsUVM2cHBSM1lmaGYxWk5GTUdSM3dxS0pUL3NXSlJKUz05eXRTb2pGcENtdVFBbEdXeDVjRDNSVXZRNHlLTk9TaWRCREUwaU5MYlAzNG9lM1V6bWNTPWZxbHM5WmpNVzAzYWhsRE9VL2ZlV1ZSUDU1anpCTkNZdVgyR2hZV0VJcm5yenNURXRXQjBnUEtPb3Qrd3MwQWlRcDg5TEVCcEhwdTlsTXdTPWNqeWloQXJVTklmWnhjWTN0QTBaSnpIWHlJYnNUdWZWcENWUjlXZk5Ra1VwRHFJR0dlREh1d01McnJUL2FwWVlmMVdJa1dlTXl2cllMVmZraUlsSXYyM3RFUnNrRWdiNjZDam8yaHZjUjJ5eDY0Ry8vTkcwWGFENG1mRjRqZWVzUmtsVThIdS9iRzZoL2NYRDJoMFd1anBudlFHR2t1RzhZNmlyPStDMy9LMlA2NDI2MDZqdjBVWmlpaWhQQzhUS29nb2dkbTc3IiwiaW1nZXh0IjoiLmdpZiIsInNpZ25uYW1lIjoi5b6Q6I2j57uP55CG562+5ZCNIiwic2lnbnNuIjoiZ1RueG9hK0NKWjNFTjVkLzhlMHNROUhXVnlxUGJCTGtoQUl1MT1md090U1JNWUc2bXBES2N6VWxGWHZqMjRyaTciLCJ1c2VybmFtZSI6InhiIiwid2lkdGgiOiI0Ljk3In0sInByb3RlY3RlZERhdGEiOlt7ImZpZWxkIjoiaXRlbTEiLCJkZXNjIjoi5L+d5oqk6aG5MSIsInZhbHVlIjoi5ZCM5Yib6L2v5Lu25YWs5Y+4In0seyJmaWVsZCI6Iml0ZW0yIiwiZGVzYyI6IuS/neaKpOmhuTIiLCJ2YWx1ZSI6IumHkeagvOenkeaKgOaciemZkOWFrOWPuCJ9LHsiZmllbGQiOiJpdGVtMyIsImRlc2MiOiLkv53miqTpobkzIiwidmFsdWUiOiLmoLnmja7jgIrlkIjlkIzms5XjgIvlj4rmnInlhbPop4TlrprvvIznu4/lj4zmlrnljY/llYbvvIzovr7miJDkuIDoh7TvvIznrb7orqLmnKzlkIjlkIzjgIJcclxu5LiA44CB55Sy5pa55aeU5omY5LmZ5pa55Yi25L2c5peg57q45YyW5Yqe5YWs57O75YiX5Lqn5ZOB44CCXHJcbuS6jOOAgeWFt+S9k+inhOagvOWei+WPt+OAgeaVsOmHj+OAgeWNleS7t+WPiuS7t+agvOivpuingemZhOWQjua4heWNleOAglxyXG7kuInjgIHkuqTotKfml7bpl7TvvJo2MOW3peS9nOaXpVxyXG7lm5vjgIHpqozmlLbmnJ/pmZDvvJoyMOW3peS9nOaXpeOAglxyXG7kupTjgIHlj4zmlrnlnKjlkIjlkIzkuIrnlLXlrZDnrb7lrZfnm5bnq6DlkI7nq4vljbPnlJ/mlYjjgIIifV0sInNlYWxUeXBlIjoiY2xpZW50IiwicG9zaXRpb24iOnsicG9zMCI6eyJtYXJnaW5MZWZ0IjoiMzEycHgiLCJtYXJnaW5Ub3AiOiIwLjgxMjVweCJ9fSwidGltZWlkIjoxNDc2ODM5NzMwNjA0LCJ2ZXIiOnsibmFtZSI6IjEuMC4yMCIsImNvZGUiOjEwMH19'
			            }
			            ];
			/* Signature.loadSignatures(signs);
			Signature.bind({
				remove:function(fn){//签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,
					console.log('获取删除的签章ID：'+this.getSignatureid());
					fn(true);//保存成功后必须回调fn(true/false)传入true/false分别表示保存成功和失败
				
				},
				update:function(fn){//签章数据有变动时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,执行后必须回调fn(true/false)，传入true/false分别表示保存成功和失败
					console.log('获取更新的签章ID：'+this.getSignatureid());
					//console.log('获取更新的签章数据：'+this.getSignatureData());
					fn(true);
				}
			}); */

		
            ////////////////////////////////////
		 	var signatureCreator = Signature.create();
			signatureCreator.getSaveSignatures("1503455980863", function(signs){
				var signdata = new Array();
				var jsonList = eval("("+signs+")");
				for(var i=0;i<jsonList.length;i++){
					      var map = {};
					      map.signatureid = jsonList[i]["signatureId"];
					      map.signatureData = jsonList[i]["signature"];
					      signdata.push(map);
				 }
				Signature.loadSignatures(signdata); 
			});
			////////////////////////////////////
			
		 window.onbeforeunload = onbeforeunload_handler;
	     window.onunload = onunload_handler;
	     function onbeforeunload_handler() {
	       
	     }
	     function onunload_handler() {
	    	 Signature.clearRPW();
	     }  	

		
	}
</script>
</head>

<body>
<input type="hidden" name=DocumentID value=1503466807036>
<table width=760 border="0" cellspacing="0" cellpadding="0" bgcolor="000000">
<tr>
  <td colspan=2 bgcolor="#c0c0c0" height=32>
    <input type="button" pos="pos0" class="test" value="甲方签章">
	<input type="button" pos="pos3" class="test" value="乙方签章">
	<input type="button" pos="pos0" class="testSign" value="签章(数字签名)">
    <input type="button" pos="pos0" class="testHW" value="手写签名">
    <input type="button" pos="pos0" class="testBC" value="二维码">
     <input type="button" pos="pos1" class="testSave" value="保存签章"> 
   <!-- <input type="button" pos="pos0" class="testScanBC" value="扫码签章">
<!-- 	<input type="button" pos="pos1" class="test" value="盖章位置B"> -->
	<input type="button" onclick="verifySignature()" value="验证签章">
	<input type="button" onclick="showSignature()" value="显示签章">
	<input type="button" onclick="hideSignature()" value="隐藏签章">
	<input type="button" onclick="takeCare();" id="yfdiv" value="注意事项">
  
  </td>
</tr>

	<tr>
  <td id=Page>
    <table width="758" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="ffffff">
<tr><td height="80" align="center" valign="bottom"><font color="red" size="6"><b>金格网络科技公司产品订购协议<b></font></td></tr>
<tr><td height="10">&nbsp;</td></tr>
<tr>
<td>
<table width="600" border="0" cellspacing="0" cellpadding="0" align="center" >
<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" nowrap>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
   <tr>
      <td width=96 align=left><font color="red">协议编号：</font></td>
<td ><input type="text" id="XYBH" name=XYBH class=inputcss value=JGKJ2004-7></td>
      <td width=96  align=right><font color="red">保密级别：</font></td>
<td ><input type="text" id="BMJH" name=BMJH  class=inputcss value=中级></td>
   </tr>
</table>
</td>
</tr>
<tr>
<td  height="300">
 <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
      <td width="100%"  style="border-bottom:1px solid; border-color:#ff0000">
	 <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">
            <tr height="150">
			<div id="pos0"  style='position:absolute;width:100%;height:100%;'  bgcolor=#ffffff>
              <td width=100 valign="top" ><font color="red" >甲方签章：</font> </td>   
			  
              <td style="border-bottom:1px solid; border-color:#ff0000;cursor:hand" valign="top"><input type="text"  name=JF  class=inputcss style="height:24 px" value="江西金格网络科技有限责任公司"></td>
			</div>
            </tr>
	 </table>
	 <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center">

            <tr height="150">
				<div id="pos0"  style="position:absolute;width:100%;height:100%;"  bgcolor=#ffffff>
              <td width=100  valign="top" ><font color="red" >乙方签章：</font></td>
			  
			  
              <td style="border-bottom:1px solid; border-color:#ff0000;cursor:hand" valign="top"><input type="text" id="YF" name=YF class=inputcss style="height:24 px"  value="XXX有限责任公司"></td>
				</div>
            </tr>

	 </table>
      </td>
   </tr>

</table>
</td>
</tr>


<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="160" nowrap >
<div name="mydiv" id="mydiv" style='position:absolute;width:100%;height:100%;'  bgcolor=#ffffff>
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
  <tr>
      <td  width="100%"  >
          <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
           <tr> <td><div id="hznrdiv"  style='position:absolute;width:100%;height:100%;'  ></div></td></tr> 
            <tr>
              <td valign="top"><font color="red" >合作内容：</font>&nbsp;
            </tr>
            <tr>
              <td height="100%">
		<Textarea name=HZNR id="HZNR" class=inputcss style="width:100%;height:100%">订购甲方iSignature 可信电子签章系统;For Word/Excel/Html/WPS/PDF/FORM/FILE/GDF 版本</Textarea>
       	      </td>
            </tr>
          </table>
      </td>
   </tr>
       </td>
            </tr>
</table>
</div>
</td>

</tr>



<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="160" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
              <td valign="top"><font color="red" >权利责任：</font>&nbsp;
            </tr>
            <tr>
              <td height="100%">
		<Textarea name=QLZR  class=inputcss style="width:100%;height:100%" >内容完整性鉴别</Textarea>
       </td>
            </tr>
</table>
</td>
</tr>
<tr>

<td style="border-bottom:1px solid; border-color:#ff0000" height="40" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
      <td width="100"  ><font color="red">&nbsp;产品名称：</font></td>
	  <td><input type="text" name=CPMC  class=inputcss value=iSignature电子签章系统></td>
   </tr>
</table>
</td>
</tr>
<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="40" nowrap  >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%" >
   <tr>
      <td width="100" ><font color="red">&nbsp;订购数量：</font></td>
	  <td><input type="text" name=DGSL  class=inputcss  value=40></td>
   </tr>
</table>
</td>
</tr>
<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="40" nowrap >
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" height="100%">
   <tr>
      <td width="100" ><font color="red">&nbsp;订购日期：</font></td>
      <td><input type="text" name=DGRQ  class=inputcss  value=2017-08-23></td>
   </tr>
</table>
</td>
</tr>


<tr>
<td style="border-bottom:1px solid; border-color:#ff0000" height="1" nowrap >
</td>
</tr>
</table>
</td>
</tr>
<tr><td height="60">&nbsp;</td></tr>
    </table>

  </td>
  <td width=2></td>
</tr>
<tr>
  <td height=2></td>
  <td></td>
</tr>

</table>
</body>

<script type="text/javascript">


function verifySignature() {

	var invalidSignatureArray = Signature.verify();//返回无效签章
	if (invalidSignatureArray.length > 0) {
		for (var i = 0; i < invalidSignatureArray.length; i++) {
			var signature = invalidSignatureArray[i];
			//console.log(signature.modifiedItems);//获取修改的保护项
		}
		
	}else{
		Signature.alert("当前文档所有签章有效");
	}
}
function findUpdateSignature(){
	var updateList = Signature.updateList;
	$('#pos2').html('<div>获取有更新的签章数据:</div>');
	for (var i = 0; i < updateList.length; i++) {
		var signature = updateList[i];
		$('#pos2').append('<div>'+signature.getSignatureid()+":"+signature.getSignatureData()+'</div>');
	}
}

function findRemoveSignature(){
	var removeList = Signature.removeList;
	$('#pos1').html('<div>获取删除的签章ID：</div>');
	for (var i = 0; i < removeList.length; i++) {
		var signatureid = removeList[i];
		$('#pos1').append('<div>'+signatureid+'</div>');
	}
}

function showSignature() {
	Signature.show();
}


function hideSignature() {
	Signature.hide();
}


$('.test').click(function() {
			
	var signatureCreator = Signature.create(/* {
			keysn : '000000999516', //可以通过密钥盘序号或者用户编码获取签章。
			authcode:'F08902A0DBE849BEB0EE076115B6C0FC'
		    //usercode:'4D58323738136645'//获取签章服务器用户编码为“test”的印章	
		} */);
		var that = this;
		var protectedItems = signatureCreator.run({
			protectedItems : [ 'XYBH'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
			position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
			autoCert : false,
			okCall : function(fn, image) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
				console.log("盖章ID：" + this.getSignatureid());
				console.log("盖章数据：" + this.getSignatureData());
				fn(true);

			},
			cancelCall : function() {//点击取消后的回调方法
				console.log("取消！")
			}
		});
	});

	$('.testSign').click(function() {
		var signatureCreator = Signature.create({
			keysn : '0741170010110516', //可以通过密钥盘序号或者用户编码获取签章。
		//usercode:'4D58323738136645'//获取签章服务器用户编码为“test”的印章	
		});
		var that = this;
		var protectedItems = signatureCreator.run({
			//protectedItems : [ 'item1'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
			position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
			autoCert : true,
			okCall : function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
				console.log("盖章ID：" + this.getSignatureid());
				console.log("盖章数据：" + this.getSignatureData());
				fn(true);

			},
			cancelCall : function() {//点击取消后的回调方法
				console.log("取消！")
			}
		});
	});

	$('.testHW').click(
			function(){
				var signatureCreator = Signature.create();
				var that = this;
				
				signatureCreator.handWriteDlg({
					image_height: "6.7",
					image_width: "5",
					onBegin: function() {
						console.log('onbegin');
					},
					onEnd: function() {
						console.log('onEnd');
					}
				}, function(param){
					//alert(param.imageData);
					signatureCreator.runHW(param, {
						protectedItems:[ 'item1', 'item2', 'item3'],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
						position: $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
						okCall: function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
							console.log("盖章ID："+this.getSignatureid());
							console.log("盖章数据："+this.getSignatureData());
							fn(true);
						},
						cancelCall : function() {//点击取消后的回调方法
							console.log("取消！")
						}
					});
				});
			}
		);

	$('.testBC').click(function() {
		var signatureCreator = Signature.create();
		var that = this;

		signatureCreator.barCodeDlg({
			image_height : "6.7",
			image_width : "5",
		}, function(param) {
			alert(param.imageData);
			signatureCreator.runHW(param, {
				protectedItems : [ 'item1', 'item2', 'item3' ],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
				position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
				okCall : function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
					console.log("盖章ID：" + this.getSignatureid());
					console.log("盖章数据：" + this.getSignatureData());
					fn(true);
				},
				cancelCall : function() {//点击取消后的回调方法
					console.log("取消！")
				}
			});
		});
	});

	$('.testScanBC').click(function() {
		var signatureCreator = Signature.create();
		var that = this;

		signatureCreator.scanBCDlg({
			image_height : "5",
			image_width : "5",
		}, function(param) {
			//alert(param.imageData);
			signatureCreator.runHW(param, {
				protectedItems : [ 'item1', 'item2', 'item3' ],//设置定位页面DOM的id，自动查找ID，自动获取保护DOM的kg-desc属性作为保护项描述，value属性为保护数据。不设置，表示不保护数据，签章永远有效。
				position : $(that).attr('pos'),//设置盖章定位dom的ID，必须设置
				okCall : function(fn) {//点击确定后的回调方法，this为签章对象 ,签章数据撤销时，将回调此方法，需要实现签章数据持久化（保存数据到后台数据库）,保存成功后必须回调fn(true/false)渲染签章到页面上
					console.log("盖章ID：" + this.getSignatureid());
					console.log("盖章数据：" + this.getSignatureData());
					fn(true);
				},
				cancelCall : function() {//点击取消后的回调方法
					console.log("取消！")
				}
			});
		});
	});
	
	$('.testSave').click(
			function(){
				var signatureCreator = Signature.create();
				var that = this;
				var list = Signature.list;
				for ( var key in list) {
					var tt = list[key];
					signatureCreator.saveSignature("1503466807036", key, list[key].getSignatureData());
				}
				alert("签章保存成功！");
			}
	   ); 

	function takeCare() {
		Signature
				.alert('注意：（1）请先在签章服务器发放用户编码为"test"的用户并做印章。<br>（2） 由于IE9及以下浏览器受限，请使用其他浏览器访问本页面，如果需要IE访问，<br>复制本页面目录和kinggrid文件夹至服务器端访问。 ');
	}

	function modifyPwd() {

		var signatureCreator = Signature.create();
		console.log(signatureCreator);
		signatureCreator.modifyPwd({
			successCall : function(response) {

			},
			errorCall : function(code) {

			}
		});

	}
</script>
